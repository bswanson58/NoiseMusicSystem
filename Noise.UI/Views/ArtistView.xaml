<UserControl x:Class="Noise.UI.Views.ArtistView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:adapters="clr-namespace:Noise.UI.Adapters"
             xmlns:Behaviours="clr-namespace:Noise.UI.Behaviours"
             xmlns:Controls="clr-namespace:Noise.UI.Controls"
             xmlns:Custom="http://schemas.AvalonControls/AvalonControlsLibrary/Controls"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:EventCommandTriggers="clr-namespace:Noise.UI.Behaviours.EventCommandTriggers"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:local="clr-namespace:Noise.UI.ValueConverters"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignHeight="500"
             d:DesignWidth="800"
             mc:Ignorable="d">
    <!--
        d:DataContext="{d:DesignInstance BlendableViewModels:BlendableArtistViewModel,
        IsDesignTimeCreatable=True}"
    -->
    <UserControl.Resources>
        <local:ByteImageConverter x:Key="imageConverter" />
        <local:HtmlTextConverter x:Key="htmlConverter" />
        <local:PublishedYearConverter x:Key="PublishedYearConverter" />
    </UserControl.Resources>

    <UserControl.DataContext>
        <Binding Path="ArtistViewModel" Source="{StaticResource ViewModelLocator}" />
    </UserControl.DataContext>

    <i:Interaction.Behaviors>
        <Behaviours:InteractionRequestDialogBehavior DialogClass="ArtistEdit"
                                                     DialogService="{Binding Source={StaticResource DialogService}}"
                                                     InteractionRequest="{Binding Path=ArtistEditRequest}" />
    </i:Interaction.Behaviors>

    <GroupBox Margin="0"
              BorderBrush="{DynamicResource TrimColor}"
              BorderThickness="1"
              Header=" Artist ">
        <Grid Visibility="{Binding Path=ArtistValid, Converter={StaticResource BooleanVisibilityConverter}}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Border Grid.Row="0"
                    Background="{DynamicResource TreeItemBackground}"
                    BorderThickness="0"
                    CornerRadius="5">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Image Grid.Column="0"
                           MaxWidth="300"
                           MaxHeight="200"
                           Margin="7"
                           Source="{Binding ArtistImage,
                                            Converter={StaticResource imageConverter}}"
                           Stretch="Uniform" />
                    <Grid Grid.Column="2" Margin="3,0,25,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <TextBlock Margin="0,0,0,9"
                                   HorizontalAlignment="Right"
                                   FontSize="20"
                                   Text="{Binding Path=Artist.Name}" />

                        <!--  Rating controls  -->
                        <StackPanel Grid.Row="1"
                                    Margin="0,1"
                                    HorizontalAlignment="Right"
                                    Orientation="Horizontal">
                            <CheckBox Margin="0,0,7,0"
                                      VerticalAlignment="Center"
                                      IsChecked="{Binding Path=Artist.UiIsFavorite,
                                                          Mode=TwoWay}"
                                      Style="{StaticResource FavoriteCheckBoxStyle}" />
                            <Controls:RatingControl Rating="{Binding Path=Artist.UiRating, Mode=TwoWay}" Style="{StaticResource NoiseRatingStyle}" />
                        </StackPanel>

                        <TextBlock x:Name="Genre"
                                   Grid.Row="2"
                                   HorizontalAlignment="Right"
                                   Text="{Binding Path=Artist.Genre}" />

                        <!--  Artist website link  -->
                        <Controls:LinkLabel Grid.Row="3"
                                            HorizontalAlignment="Right"
                                            Content="{Binding Path=ArtistWebsite.DisplayText}"
                                            IsEnabled="{Binding Path=ArtistWebsite.IsLinked}"
                                            LinkLabelBehavior="HoverUnderline"
                                            Padding="0">
                            <EventCommandTriggers:CommandSource.Trigger>
                                <EventCommandTriggers:EventCommandTrigger Command="{Binding Path=ArtistWebsite.LinkClicked}" RoutedEvent="Controls:LinkLabel.Click" />
                            </EventCommandTriggers:CommandSource.Trigger>
                        </Controls:LinkLabel>

                        <Button Grid.Row="5"
                                Width="19"
                                Height="19"
                                Margin="0,0,0,5"
                                HorizontalAlignment="Right"
                                Command="{Binding Path=EditArtist}"
                                Content="{StaticResource Path_Edit}"
                                Foreground="{StaticResource ControlTextColor}"
                                Padding="2"
                                ToolTip="Edit Artist Properties" />

                    </Grid>
                </Grid>
            </Border>
            <ScrollViewer Grid.Row="1" Behaviours:ScrollViewerPosition.ChangeTrigger="{Binding Path=Artist, Mode=OneWay}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="115" />
                        <RowDefinition Height="150" />
                    </Grid.RowDefinitions>
                    <FlowDocumentScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Hidden">
                        <FlowDocument ColumnWidth="100"
                                      IsHyphenationEnabled="True"
                                      IsOptimalParagraphEnabled="True">
                            <Paragraph>
                                <adapters:BindableRun BoundText="{Binding Path=ArtistBio, Converter={StaticResource htmlConverter}}" />
                            </Paragraph>
                        </FlowDocument>
                    </FlowDocumentScrollViewer>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="1*" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <GroupBox Grid.Column="0"
                                  Margin="5,3,0,3"
                                  BorderBrush="{DynamicResource TrimColor}"
                                  BorderThickness="1"
                                  Header=" Band Members ">
                            <ListBox BorderThickness="0" ItemsSource="{Binding Path=BandMembers}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Path=DisplayText}" />
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                        <GroupBox Grid.Column="1"
                                  Margin="5,3,0,3"
                                  BorderBrush="{DynamicResource TrimColor}"
                                  BorderThickness="1"
                                  Header=" TopAlbums ">
                            <ListBox BorderThickness="0" ItemsSource="{Binding Path=TopAlbums}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Controls:LinkLabel Content="{Binding Path=DisplayText}"
                                                            IsEnabled="{Binding Path=IsLinked}"
                                                            LinkLabelBehavior="HoverUnderline"
                                                            Padding="0">
                                            <EventCommandTriggers:CommandSource.Trigger>
                                                <EventCommandTriggers:EventCommandTrigger Command="{Binding Path=LinkClicked}" RoutedEvent="Controls:LinkLabel.Click" />
                                            </EventCommandTriggers:CommandSource.Trigger>
                                        </Controls:LinkLabel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                        <GroupBox Grid.Column="2"
                                  Margin="5,3,5,3"
                                  BorderBrush="{DynamicResource TrimColor}"
                                  BorderThickness="1"
                                  Header=" Similar Artists ">
                            <ListBox BorderThickness="0" ItemsSource="{Binding Path=SimilarArtist}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Controls:LinkLabel Content="{Binding Path=DisplayText}"
                                                            IsEnabled="{Binding Path=IsLinked}"
                                                            LinkLabelBehavior="HoverUnderline"
                                                            Padding="0">
                                            <EventCommandTriggers:CommandSource.Trigger>
                                                <EventCommandTriggers:EventCommandTrigger Command="{Binding Path=LinkClicked}" RoutedEvent="Controls:LinkLabel.Click" />
                                            </EventCommandTriggers:CommandSource.Trigger>
                                        </Controls:LinkLabel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                    </Grid>
                    <GroupBox Grid.Row="2"
                              Margin="5,0,5,5"
                              BorderBrush="{DynamicResource TrimColor}"
                              BorderThickness="1"
                              Header=" Discography ">
                        <ListView Behaviours:GridViewSort.AutoSort="True"
                                  Behaviours:ListViewColumns.Stretch="true"
                                  BorderThickness="0"
                                  ItemsSource="{Binding Path=Discography}">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="{x:Type ListViewItem}">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                    <Setter Property="Focusable" Value="false" />
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{x:Null}" />
                                            <Setter Property="BorderBrush" Value="{x:Null}" />
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Behaviours:GridViewSort.PropertyName="Title" Header="Title">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Path=Title}" TextAlignment="Left" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Width="210"
                                                    Behaviours:GridViewSort.PropertyName="Label"
                                                    Header="Label">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Path=Label}" TextAlignment="Left" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Width="190"
                                                    Behaviours:GridViewSort.PropertyName="Format"
                                                    Header="Format">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Path=Format}" TextAlignment="Left" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Width="75"
                                                    Behaviours:GridViewSort.PropertyName="Year"
                                                    Header="Released">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Path=Year, Converter={StaticResource PublishedYearConverter}}" TextAlignment="Right" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>

                        </ListView>
                    </GroupBox>
                </Grid>
            </ScrollViewer>
        </Grid>
    </GroupBox>
</UserControl>
