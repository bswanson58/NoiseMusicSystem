<UserControl x:Class="Noise.UI.Views.LibraryAdditionsView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:Behaviours="clr-namespace:Noise.UI.Behaviours"
			 xmlns:ValueConverters="clr-namespace:ReusableBits.Ui.ValueConverters;assembly=ReusableBits.Ui"
			 xmlns:compMod="clr-namespace:System.ComponentModel;assembly=WindowsBase"
			 xmlns:ReusableBehaviours="clr-namespace:ReusableBits.Ui.Behaviours;assembly=ReusableBits.Ui"
			 DataContext="{Binding LibraryAdditionsViewModel, Source={StaticResource ViewModelLocator}}"
			 Tag="What's New"
			 AllowDrop="{Binding DisplayMarker}"
			 ReusableBehaviours:ViewDisplayedNotifier.NotifyCommand="{Binding ViewDisplayed}"
			 mc:Ignorable="d" 
			 d:DesignHeight="300" d:DesignWidth="300">
			<!-- The AllowDrop property is used to hold the boolean flag for displaying the marker on the TabItem header -->
	
	<Control.Resources>
		<ValueConverters:NumericRangeValueConverter x:Key="NumericRangeValueConverter" MinimumOutput="0.2" MaximumOutput="1.0"/>
		
		<CollectionViewSource Source="{Binding NodeList}" x:Key="SortedNodes" >
			<CollectionViewSource.SortDescriptions>
				<compMod:SortDescription PropertyName="Album.DateAddedTicks" Direction="Descending"/>
			</CollectionViewSource.SortDescriptions>
		</CollectionViewSource>
	</Control.Resources>

	<Grid>
		<GroupBox Style="{StaticResource SectionBorderStyle}" Header=" What's New ">
			<ListView Grid.Row="0" BorderThickness="0"
			          ItemContainerStyle="{StaticResource ListViewItemStretch}"
					  ItemsSource="{Binding Source={StaticResource SortedNodes}}" SelectedItem="{Binding SelectedNode}"
					  Behaviours:ListViewColumns.Stretch="true" 
					  Behaviours:GridViewSort.AutoSort="True">
				<ListView.View>
					<GridView>
						<GridViewColumn HeaderTemplate="{StaticResource PlayColumnHeaderTemplate}" Width="27">
							<GridViewColumn.CellTemplate>
								<DataTemplate>
									<Button Style="{StaticResource PlayButtonStyle}" Command="{Binding Path=Play}"/>
								</DataTemplate>
							</GridViewColumn.CellTemplate>
						</GridViewColumn>
						<GridViewColumn Header="Artist / Album" Behaviours:GridViewSort.PropertyName="Name">
							<GridViewColumn.CellTemplate>
								<DataTemplate>
									<StackPanel x:Name="ItemPanel" Orientation="Horizontal"
												Opacity="{Binding Path=RelativeAge, Converter={StaticResource NumericRangeValueConverter}}">
										<TextBlock Style="{StaticResource ListViewTextStyle}" Text="{Binding Path=Artist.Name}"/>
										<TextBlock Style="{StaticResource ListViewTextStyle}" Text="/"/>
										<TextBlock Style="{StaticResource ListViewTextStyle}" Text="{Binding Path=Album.Name}"/>
									</StackPanel>
									<DataTemplate.Triggers>
										<Trigger SourceName="ItemPanel" Property="IsMouseOver" Value="True">
											<Setter TargetName="ItemPanel" Property="Opacity" Value="1.0"/>
										</Trigger>
									</DataTemplate.Triggers>
								</DataTemplate>
							</GridViewColumn.CellTemplate>
						</GridViewColumn>
					</GridView>
				</ListView.View>
			</ListView>
		</GroupBox>
	</Grid>
</UserControl>
